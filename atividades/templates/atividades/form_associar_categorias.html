{% extends 'base_coord.html' %}
{% block title %}Associar Categorias ao Curso{% endblock %}
{% load widget_tweaks %}
{% block content %}
<div class="card shadow-sm mx-auto mt-5" style="max-width: 700px;">
  <div class="card-header bg-white border-bottom-0">
    <h4 class="mb-0 text-main-green"><i class="bi bi-check2-square"></i> Associar Categorias ao Curso: {{ curso_nome }}</h4>
  </div>
  <div class="card-body bg-white">
    <form method="post">
      {% csrf_token %}
      {% if cursos %}
        <div class="mb-3">
          <label for="curso_id" class="form-label">Selecione o curso:</label>
          <select name="curso_id" id="curso_id" class="form-select" onchange="this.form.submit()">
            <option value="" disabled selected>-- Escolha --</option>
            {% for c in cursos %}
              <option value="{{ c.id }}" {% if c.id|stringformat:'s' == curso_selecionado|stringformat:'s' %}selected{% endif %}>{{ c.nome }}</option>
            {% endfor %}
          </select>
        </div>
      {% endif %}
      {% if categorias %}
          <table class="table table-bordered align-middle">
            <thead>
              <tr>
                <th>Selecionar</th>
                <th>Categoria</th>
                <th>Limite de horas</th>
              </tr>
            </thead>
            <tbody>
              {% for categoria in categorias %}
              <tr>
                <td>
                  <input type="checkbox" name="cat_{{ categoria.id }}" id="id_cat_{{ categoria.id }}">
                </td>
                <td>{{ categoria.nome }}</td>
                <td>
                  <input type="number" step="0.01" min="0" name="horas_{{ categoria.id }}" id="id_horas_{{ categoria.id }}" class="form-control" style="max-width:120px;">
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
          <button type="submit" class="btn btn-success"><i class="bi bi-check-lg"></i> Associar Selecionadas</button>
        {% elif curso_selecionado %}
          <div class="alert alert-warning text-center mt-3 mb-0">Nenhuma categoria disponível para associação neste curso.</div>
        {% endif %}

    </form>
  </div>
</div>
{% endblock %}
